extern fn printf(str: i8*, ...): void;

fn iter_foo(): impl i32 {
    for (let i = 0; i < 5; i += 1)
    {
        printf("before %d\n", i);
        yield i;
        printf("after %d\n", i);
    }

    return;
}

fn main(): i32 
{
    let frame = iter_foo();

    let test = iter_foo_send(&frame);

    while (!test.done)
    {
        printf("%d\n", test.value);
        test = iter_foo_send(&frame);
    }

    return 1;
}